[08/25 12:05:29 d2.data.datasets.coco]: Loaded 5000 images in COCO format from datasets/coco/annotations/instances_val2017.json
[08/25 12:05:29 d2.data.build]: Distribution of instances among all 80 categories:
|   category    | #instances   |   category   | #instances   |   category    | #instances   |
|:-------------:|:-------------|:------------:|:-------------|:-------------:|:-------------|
|    person     | 10777        |   bicycle    | 314          |      car      | 1918         |
|  motorcycle   | 367          |   airplane   | 143          |      bus      | 283          |
|     train     | 190          |    truck     | 414          |     boat      | 424          |
| traffic light | 634          | fire hydrant | 101          |   stop sign   | 75           |
| parking meter | 60           |    bench     | 411          |     bird      | 427          |
|      cat      | 202          |     dog      | 218          |     horse     | 272          |
|     sheep     | 354          |     cow      | 372          |   elephant    | 252          |
|     bear      | 71           |    zebra     | 266          |    giraffe    | 232          |
|   backpack    | 371          |   umbrella   | 407          |    handbag    | 540          |
|      tie      | 252          |   suitcase   | 299          |    frisbee    | 115          |
|     skis      | 241          |  snowboard   | 69           |  sports ball  | 260          |
|     kite      | 327          | baseball bat | 145          | baseball gl.. | 148          |
|  skateboard   | 179          |  surfboard   | 267          | tennis racket | 225          |
|    bottle     | 1013         |  wine glass  | 341          |      cup      | 895          |
|     fork      | 215          |    knife     | 325          |     spoon     | 253          |
|     bowl      | 623          |    banana    | 370          |     apple     | 236          |
|   sandwich    | 177          |    orange    | 285          |   broccoli    | 312          |
|    carrot     | 365          |   hot dog    | 125          |     pizza     | 284          |
|     donut     | 328          |     cake     | 310          |     chair     | 1771         |
|     couch     | 261          | potted plant | 342          |      bed      | 163          |
| dining table  | 695          |    toilet    | 179          |      tv       | 288          |
|    laptop     | 231          |    mouse     | 106          |    remote     | 283          |
|   keyboard    | 153          |  cell phone  | 262          |   microwave   | 55           |
|     oven      | 143          |   toaster    | 9            |     sink      | 225          |
| refrigerator  | 126          |     book     | 1129         |     clock     | 267          |
|     vase      | 274          |   scissors   | 36           |  teddy bear   | 190          |
|  hair drier   | 11           |  toothbrush  | 57           |               |              |
|     total     | 36335        |              |              |               |              |
[08/25 12:05:29 d2.data.dataset_mapper]: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[08/25 12:05:29 d2.data.common]: Serializing the dataset using: <class 'detectron2.data.common._TorchSerializedList'>
[08/25 12:05:29 d2.data.common]: Serializing 5000 elements to byte tensors and concatenating them all ...
[08/25 12:05:29 d2.data.common]: Serialized dataset takes 19.10 MiB
[08/25 12:05:30 d2.checkpoint.detection_checkpoint]: [DetectionCheckpointer] Loading from detectron2://ImageNetPretrained/MSRA/R-50.pkl ...
[08/25 12:05:30 fvcore.common.checkpoint]: [Checkpointer] Loading from /home/linxu/.torch/iopath_cache/detectron2/ImageNetPretrained/MSRA/R-50.pkl ...
[08/25 12:05:30 d2.checkpoint.c2_model_loading]: Renaming Caffe2 weights ......
[08/25 12:05:30 d2.checkpoint.c2_model_loading]: Following weights matched with submodule backbone.bottom_up:
| Names in Model    | Names in Checkpoint      | Shapes                                          |
|:------------------|:-------------------------|:------------------------------------------------|
| res2.0.conv1.*    | res2_0_branch2a_{bn_*,w} | (64,) (64,) (64,) (64,) (64,64,1,1)             |
| res2.0.conv2.*    | res2_0_branch2b_{bn_*,w} | (64,) (64,) (64,) (64,) (64,64,3,3)             |
| res2.0.conv3.*    | res2_0_branch2c_{bn_*,w} | (256,) (256,) (256,) (256,) (256,64,1,1)        |
| res2.0.shortcut.* | res2_0_branch1_{bn_*,w}  | (256,) (256,) (256,) (256,) (256,64,1,1)        |
| res2.1.conv1.*    | res2_1_branch2a_{bn_*,w} | (64,) (64,) (64,) (64,) (64,256,1,1)            |
| res2.1.conv2.*    | res2_1_branch2b_{bn_*,w} | (64,) (64,) (64,) (64,) (64,64,3,3)             |
| res2.1.conv3.*    | res2_1_branch2c_{bn_*,w} | (256,) (256,) (256,) (256,) (256,64,1,1)        |
| res2.2.conv1.*    | res2_2_branch2a_{bn_*,w} | (64,) (64,) (64,) (64,) (64,256,1,1)            |
| res2.2.conv2.*    | res2_2_branch2b_{bn_*,w} | (64,) (64,) (64,) (64,) (64,64,3,3)             |
| res2.2.conv3.*    | res2_2_branch2c_{bn_*,w} | (256,) (256,) (256,) (256,) (256,64,1,1)        |
| res3.0.conv1.*    | res3_0_branch2a_{bn_*,w} | (128,) (128,) (128,) (128,) (128,256,1,1)       |
| res3.0.conv2.*    | res3_0_branch2b_{bn_*,w} | (128,) (128,) (128,) (128,) (128,128,3,3)       |
| res3.0.conv3.*    | res3_0_branch2c_{bn_*,w} | (512,) (512,) (512,) (512,) (512,128,1,1)       |
| res3.0.shortcut.* | res3_0_branch1_{bn_*,w}  | (512,) (512,) (512,) (512,) (512,256,1,1)       |
| res3.1.conv1.*    | res3_1_branch2a_{bn_*,w} | (128,) (128,) (128,) (128,) (128,512,1,1)       |
| res3.1.conv2.*    | res3_1_branch2b_{bn_*,w} | (128,) (128,) (128,) (128,) (128,128,3,3)       |
| res3.1.conv3.*    | res3_1_branch2c_{bn_*,w} | (512,) (512,) (512,) (512,) (512,128,1,1)       |
| res3.2.conv1.*    | res3_2_branch2a_{bn_*,w} | (128,) (128,) (128,) (128,) (128,512,1,1)       |
| res3.2.conv2.*    | res3_2_branch2b_{bn_*,w} | (128,) (128,) (128,) (128,) (128,128,3,3)       |
| res3.2.conv3.*    | res3_2_branch2c_{bn_*,w} | (512,) (512,) (512,) (512,) (512,128,1,1)       |
| res3.3.conv1.*    | res3_3_branch2a_{bn_*,w} | (128,) (128,) (128,) (128,) (128,512,1,1)       |
| res3.3.conv2.*    | res3_3_branch2b_{bn_*,w} | (128,) (128,) (128,) (128,) (128,128,3,3)       |
| res3.3.conv3.*    | res3_3_branch2c_{bn_*,w} | (512,) (512,) (512,) (512,) (512,128,1,1)       |
| res4.0.conv1.*    | res4_0_branch2a_{bn_*,w} | (256,) (256,) (256,) (256,) (256,512,1,1)       |
| res4.0.conv2.*    | res4_0_branch2b_{bn_*,w} | (256,) (256,) (256,) (256,) (256,256,3,3)       |
| res4.0.conv3.*    | res4_0_branch2c_{bn_*,w} | (1024,) (1024,) (1024,) (1024,) (1024,256,1,1)  |
| res4.0.shortcut.* | res4_0_branch1_{bn_*,w}  | (1024,) (1024,) (1024,) (1024,) (1024,512,1,1)  |
| res4.1.conv1.*    | res4_1_branch2a_{bn_*,w} | (256,) (256,) (256,) (256,) (256,1024,1,1)      |
| res4.1.conv2.*    | res4_1_branch2b_{bn_*,w} | (256,) (256,) (256,) (256,) (256,256,3,3)       |
| res4.1.conv3.*    | res4_1_branch2c_{bn_*,w} | (1024,) (1024,) (1024,) (1024,) (1024,256,1,1)  |
| res4.2.conv1.*    | res4_2_branch2a_{bn_*,w} | (256,) (256,) (256,) (256,) (256,1024,1,1)      |
| res4.2.conv2.*    | res4_2_branch2b_{bn_*,w} | (256,) (256,) (256,) (256,) (256,256,3,3)       |
| res4.2.conv3.*    | res4_2_branch2c_{bn_*,w} | (1024,) (1024,) (1024,) (1024,) (1024,256,1,1)  |
| res4.3.conv1.*    | res4_3_branch2a_{bn_*,w} | (256,) (256,) (256,) (256,) (256,1024,1,1)      |
| res4.3.conv2.*    | res4_3_branch2b_{bn_*,w} | (256,) (256,) (256,) (256,) (256,256,3,3)       |
| res4.3.conv3.*    | res4_3_branch2c_{bn_*,w} | (1024,) (1024,) (1024,) (1024,) (1024,256,1,1)  |
| res4.4.conv1.*    | res4_4_branch2a_{bn_*,w} | (256,) (256,) (256,) (256,) (256,1024,1,1)      |
| res4.4.conv2.*    | res4_4_branch2b_{bn_*,w} | (256,) (256,) (256,) (256,) (256,256,3,3)       |
| res4.4.conv3.*    | res4_4_branch2c_{bn_*,w} | (1024,) (1024,) (1024,) (1024,) (1024,256,1,1)  |
| res4.5.conv1.*    | res4_5_branch2a_{bn_*,w} | (256,) (256,) (256,) (256,) (256,1024,1,1)      |
| res4.5.conv2.*    | res4_5_branch2b_{bn_*,w} | (256,) (256,) (256,) (256,) (256,256,3,3)       |
| res4.5.conv3.*    | res4_5_branch2c_{bn_*,w} | (1024,) (1024,) (1024,) (1024,) (1024,256,1,1)  |
| res5.0.conv1.*    | res5_0_branch2a_{bn_*,w} | (512,) (512,) (512,) (512,) (512,1024,1,1)      |
| res5.0.conv2.*    | res5_0_branch2b_{bn_*,w} | (512,) (512,) (512,) (512,) (512,512,3,3)       |
| res5.0.conv3.*    | res5_0_branch2c_{bn_*,w} | (2048,) (2048,) (2048,) (2048,) (2048,512,1,1)  |
| res5.0.shortcut.* | res5_0_branch1_{bn_*,w}  | (2048,) (2048,) (2048,) (2048,) (2048,1024,1,1) |
| res5.1.conv1.*    | res5_1_branch2a_{bn_*,w} | (512,) (512,) (512,) (512,) (512,2048,1,1)      |
| res5.1.conv2.*    | res5_1_branch2b_{bn_*,w} | (512,) (512,) (512,) (512,) (512,512,3,3)       |
| res5.1.conv3.*    | res5_1_branch2c_{bn_*,w} | (2048,) (2048,) (2048,) (2048,) (2048,512,1,1)  |
| res5.2.conv1.*    | res5_2_branch2a_{bn_*,w} | (512,) (512,) (512,) (512,) (512,2048,1,1)      |
| res5.2.conv2.*    | res5_2_branch2b_{bn_*,w} | (512,) (512,) (512,) (512,) (512,512,3,3)       |
| res5.2.conv3.*    | res5_2_branch2c_{bn_*,w} | (2048,) (2048,) (2048,) (2048,) (2048,512,1,1)  |
| stem.conv1.norm.* | res_conv1_bn_*           | (64,) (64,) (64,) (64,)                         |
| stem.conv1.weight | conv1_w                  | (64, 3, 7, 7)                                   |
WARNING [08/25 12:05:30 fvcore.common.checkpoint]: Some model parameters or buffers are not found in the checkpoint:
backbone.fpn_lateral2.{bias, weight}
backbone.fpn_lateral3.{bias, weight}
backbone.fpn_lateral4.{bias, weight}
backbone.fpn_lateral5.{bias, weight}
backbone.fpn_output2.{bias, weight}
backbone.fpn_output3.{bias, weight}
backbone.fpn_output4.{bias, weight}
backbone.fpn_output5.{bias, weight}
proposal_generator.rpn_head.anchor_deltas.{bias, weight}
proposal_generator.rpn_head.conv.{bias, weight}
proposal_generator.rpn_head.objectness_logits.{bias, weight}
roi_heads.box_head.fc1.{bias, weight}
roi_heads.box_head.fc2.{bias, weight}
roi_heads.box_predictor.bbox_pred.{bias, weight}
roi_heads.box_predictor.cls_score.{bias, weight}
WARNING [08/25 12:05:30 fvcore.common.checkpoint]: The checkpoint state_dict contains keys that are not used by the model:
  fc1000.{bias, weight}
  stem.conv1.bias
  0%|                                                                                                                                                                                        | 0/100 [00:00<?, ?it/s]/home/linxu/anaconda3/envs/dev/lib/python3.9/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
WARNING [08/25 12:05:31 fvcore.nn.jit_analysis]: Unsupported operator prim::CallFunction encountered 21 time(s)
WARNING [08/25 12:05:31 fvcore.nn.jit_analysis]: Unsupported operator aten::pad encountered 1 time(s)
WARNING [08/25 12:05:31 fvcore.nn.jit_analysis]: Unsupported operator aten::topk encountered 5 time(s)
WARNING [08/25 12:05:31 fvcore.nn.jit_analysis]: Unsupported operator torchvision::roi_align encountered 4 time(s)
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:20<00:00,  4.91it/s]
[08/25 12:05:50 detectron2]: Flops table computed from only one input sample:
| module                                                  | #parameters or shape   | #flops     |
|:--------------------------------------------------------|:-----------------------|:-----------|
| model                                                   | 41.7M                  | 0.174T     |
|  backbone                                               |  26.799M               |  0.117T    |
|   backbone.fpn_lateral2                                 |   65.792K              |   3.565G   |
|    backbone.fpn_lateral2.weight                         |    (256, 256, 1, 1)    |            |
|    backbone.fpn_lateral2.bias                           |    (256,)              |            |
|   backbone.fpn_output2                                  |   0.59M                |   32.086G  |
|    backbone.fpn_output2.weight                          |    (256, 256, 3, 3)    |            |
|    backbone.fpn_output2.bias                            |    (256,)              |            |
|   backbone.fpn_lateral3                                 |   0.131M               |   1.783G   |
|    backbone.fpn_lateral3.weight                         |    (256, 512, 1, 1)    |            |
|    backbone.fpn_lateral3.bias                           |    (256,)              |            |
|   backbone.fpn_output3                                  |   0.59M                |   8.022G   |
|    backbone.fpn_output3.weight                          |    (256, 256, 3, 3)    |            |
|    backbone.fpn_output3.bias                            |    (256,)              |            |
|   backbone.fpn_lateral4                                 |   0.262M               |   0.891G   |
|    backbone.fpn_lateral4.weight                         |    (256, 1024, 1, 1)   |            |
|    backbone.fpn_lateral4.bias                           |    (256,)              |            |
|   backbone.fpn_output4                                  |   0.59M                |   2.005G   |
|    backbone.fpn_output4.weight                          |    (256, 256, 3, 3)    |            |
|    backbone.fpn_output4.bias                            |    (256,)              |            |
|   backbone.fpn_lateral5                                 |   0.525M               |   0.446G   |
|    backbone.fpn_lateral5.weight                         |    (256, 2048, 1, 1)   |            |
|    backbone.fpn_lateral5.bias                           |    (256,)              |            |
|   backbone.fpn_output5                                  |   0.59M                |   0.501G   |
|    backbone.fpn_output5.weight                          |    (256, 256, 3, 3)    |            |
|    backbone.fpn_output5.bias                            |    (256,)              |            |
|   backbone.bottom_up                                    |   23.455M              |   67.256G  |
|    backbone.bottom_up.stem.conv1                        |    9.408K              |    2.075G  |
|    backbone.bottom_up.res2                              |    0.213M              |    11.74G  |
|    backbone.bottom_up.res3                              |    1.212M              |    16.586G |
|    backbone.bottom_up.res4                              |    7.078M              |    24.134G |
|    backbone.bottom_up.res5                              |    14.942M             |    12.72G  |
|  proposal_generator.rpn_head                            |  0.594M                |  43.023G   |
|   proposal_generator.rpn_head.conv                      |   0.59M                |   42.745G  |
|    proposal_generator.rpn_head.conv.weight              |    (256, 256, 3, 3)    |            |
|    proposal_generator.rpn_head.conv.bias                |    (256,)              |            |
|   proposal_generator.rpn_head.objectness_logits         |   0.771K               |   55.658M  |
|    proposal_generator.rpn_head.objectness_logits.weight |    (3, 256, 1, 1)      |            |
|    proposal_generator.rpn_head.objectness_logits.bias   |    (3,)                |            |
|   proposal_generator.rpn_head.anchor_deltas             |   3.084K               |   0.223G   |
|    proposal_generator.rpn_head.anchor_deltas.weight     |    (12, 256, 1, 1)     |            |
|    proposal_generator.rpn_head.anchor_deltas.bias       |    (12,)               |            |
|  roi_heads                                              |  14.307M               |  14.304G   |
|   roi_heads.box_head                                    |   13.896M              |   13.894G  |
|    roi_heads.box_head.fc1                               |    12.846M             |    12.845G |
|    roi_heads.box_head.fc2                               |    1.05M               |    1.049G  |
|   roi_heads.box_predictor                               |   0.411M               |   0.411G   |
|    roi_heads.box_predictor.cls_score                    |    83.025K             |    82.944M |
|    roi_heads.box_predictor.bbox_pred                    |    0.328M              |    0.328G  |
[08/25 12:05:50 detectron2]: Average GFlops for each type of operators:
[('conv', 165.3214737024), ('batch_norm', 0.38140481536000004), ('upsample_nearest2d', 0.01897986048), ('linear', 14.304256)]
[08/25 12:05:50 detectron2]: Total GFlops: 180.0±18.3
